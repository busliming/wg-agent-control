"use strict";var MIDDLE_PIC_POS=1;!function(t){var i=function(i){var s=this;this.caroursel=i,this.posterList=i.find(".poster-list"),this.posterItems=i.find(".poster-item"),this.firstPosterItem=this.posterItems.first(),this.lastPosterItem=this.posterItems.last(),this.prevBtn=this.caroursel.find(".poster-prev-btn"),this.nextBtn=this.caroursel.find(".poster-next-btn"),this.curPositions=[];for(var e=0;e<this.posterItems.length;++e)this.curPositions[e]=e+1;this.setting={width:"560",height:"460",posterWidth:"760",posterHeight:"460",scale:"0.8",speed:"1000",isAutoplay:"true",dealy:"3000",algin:"middle"},t.extend(this.setting,this.getSetting()),this.setFirstPosition(),this.setSlicePosition(),this.rotateFlag=!0,this.prevBtn.bind("click",function(){s.rotateFlag&&(s.rotateFlag=!1,s.rotateAnimate("left"))}),this.nextBtn.bind("click",function(){s.rotateFlag&&(s.rotateFlag=!1,s.rotateAnimate("right"))}),this.setting.isAutoplay&&(this.autoPlay(),this.caroursel.hover(function(){clearInterval(s.timer)},function(){s.autoPlay()}))};i.prototype={autoPlay:function(){var t=this;this.timer=window.setInterval(function(){t.nextBtn.click()},t.setting.dealy)},refreshPositions:function(t){for(var i=0;i<this.curPositions.length;++i){var s=this.curPositions[i]+t;s>this.curPositions.length?s-=this.curPositions.length:s<1&&(s=this.curPositions.length+s),this.curPositions[i]=s}},cal_move_path:function(t,i,s){return t==i?null:t>i?{direct:(e=t-i)<=(h=i+(s-t))?"right":"left",step:Math.min(h,e)}:void 0;var e,h},clickPosButtonIndex:function(t){if(0!=this.rotateFlag){var i=this.curPositions[t],s=this.cal_move_path(i,MIDDLE_PIC_POS,this.curPositions.length);if(null!=s){var e=s.direct,h=s.step;this.rotateFlag=!1,this.rotateAnimate(e,h)}}},rotateAnimate:function(i,s){s=s||1;var e=this,h=[],o=e.setting.speed;this.posterItems.each(function(){for(var n=t(this),r=null,a=n,c=0;c<s;++c)r="left"==i?a.next().get(0)?a.next():e.firstPosterItem:a.prev().get(0)?a.prev():e.lastPosterItem,a=r;var l=r.css("width"),d=r.css("height"),g=r.css("zIndex"),p=r.css("opacity"),u=r.css("left"),f=r.css("top");h.push(g),n.animate({width:l,height:d,left:u,opacity:p,top:f},o,function(){e.rotateFlag=!0})}),this.posterItems.each(function(i){t(this).css("zIndex",h[i])}),"right"==i?this.refreshPositions(-s):this.refreshPositions(s)},setFirstPosition:function(){this.caroursel.css({width:this.setting.width}),this.posterList.css({width:this.setting.width,height:.5*this.setting.width});var t=(this.setting.width-this.setting.posterWidth)/2;this.prevBtn.css({width:t,zIndex:Math.ceil(this.posterItems.size()/2)}),this.nextBtn.css({width:t,zIndex:Math.ceil(this.posterItems.size()/2)}),this.firstPosterItem.css({width:this.setting.posterWidth,height:this.setting.posterHeight,left:t,zIndex:Math.ceil(this.posterItems.size()/1),top:this.setVertialType(this.setting.posterHeight)})},setSlicePosition:function(){var i=this,s=this.posterItems.slice(1),e=Math.floor(this.posterItems.length/2),h=s.slice(0,e),o=s.slice(e),n=this.setting.posterWidth,r=this.setting.posterHeight,a=(this.setting.width-this.setting.posterWidth)/2,c=a/e,l=this.setting.width,d=1,g=n,p=r,u=e;h.each(function(s,e){var h=i.setting.scale;1==s&&(h-=.2),t(this).css({width:g*h,height:p*h,left:a-d*c,zIndex:u--,opacity:1/(d+1),top:i.setVertialType(p*h)}),d++});var f=e,m=1;o.each(function(s,e){var h=i.setting.scale;o.length<=1?h=h:0==s&&(h-=.2),t(this).css({width:g*h,height:p*h,left:l-(a-f*c+g*h),zIndex:m++,opacity:1/(f+1),top:i.setVertialType(p*h)}),f--})},getSetting:function(){var t=void 0;return oWidth<1200?(t={width:oWidth-100,posterWidth:.7*oWidth,posterHeight:.5*oWidth,scale:.8,dealy:"3000",algin:"middle"},oWidth<768&&(t={width:oWidth-50,posterWidth:.8*(oWidth-100),posterHeight:.4*oWidth,scale:.8,dealy:"3000",algin:"middle"})):t={width:1e3,posterWidth:760,posterHeight:460,scale:.8,dealy:"3000",algin:"middle"},t},setVertialType:function(t){var i=this.setting.align;return"top"==i?0:"middle"==i?(this.setting.posterHeight-t)/2:"bottom"==i?this.setting.posterHeight-t:(this.setting.posterHeight-t)/2}},i.init=function(s){s.each(function(s,e){new i(t(this))})},window.Caroursel=i}(jQuery);